# tomcat 인스턴스화 시키기

## 기초 환경
실습에서는 VM 리눅스에 3가지의 톰캣을 만들어 실습해봤다.

`📁 Tomcat`
`📁 Jenkins Tomcat`
`📁 cafe24 Tomcat`

위 세가지의 환경을 연동하여

- ~~기본 Tomcat에서는 Jenkins와 cafe24의 conf의 세팅을 담당한다.~~
- Jenkins 톰캣에서는 Jenkins를 이용해 프로젝트의 빌드, 빌드한 war파일을 cafe24톰캣 webapps에 전송한다.
- cafe24 톰캣에서는 Jenkins에서 받은 빌드 파일을 통해 작동한다.

`📁 Jenkins`와 `📁 cafe24`에서는 bin에 startup.sh과 shutdown.sh를 생성하는데,

#### 📝startup.sh
```shell
#!/usr/bin/env bash
export CATALINA_BASE=/usr/local/cafe24/tomcat-cafe24
export JAVA_OPTS="-Djava.awt.headless=true -server -Xms512m -Xmx1024m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=256m -XX:MaxPermSize=512m -XX:+DisableExplicitGC"
export CATALINA_OPTS="-Denv=product -Denv.servername=cafe24"

$CATALINA_HOME/bin/catalina.sh start
```

#### 📝shutdown.sh
```shell
#!/usr/bin/env bash

export CATALINA_BASE=/usr/local/cafe24/tomcat-cafe24
export JAVA_OPTS="-Djava.awt.headless=true -server -Xms512m -Xmx1024m -XX:NewSize=256m -XX:MaxNewSize=256m -XX:PermSize=256m -XX:MaxPermSize=512m -XX:+DisableExplicitGC"
export CATALINA_OPTS="-Denv=product -Denv.servername=cafe24"

$CATALINA_HOME/bin/catalina.sh stop
```

`$CATALINA_HOME/bin/catalina.sh start/stop`은 기본 톰캣 `📁 Tomcat`으로 구동되는 형식이다.

젠킨스도 같은 맥락으로 동작하며

`📁 /etc/init.d`에 cafe24와 Jenkins의 톰캣 시작 스크립트를 넣는것으로 서버 구동시 톰캣 시작 세팅을 설정한다.

```bash
chkconfig --add/--del SERVICE_NAME

chkconfig SERVICE_NAME ON/OFF
```
같은 명령어도 잊지말자.






































```xml
<plugin>
	<artifactId>maven-war-plugin</artifactId>
	<configuration>
	<failOnMissingWebXml>false</failOnMissingWebXml>
	<warSourceDirectory>src/main/webapp</warSourceDirectory>
	</configuration>
</plugin>
```
> 멀티프로젝트에 관한 세팅시 webxml빼고 빌드할때 사용하는 옵션 (failOnMissingWebXml) webxml이 빠졌을때 빌드가 실패하는것을 막는다.
